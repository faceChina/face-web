(function(){"use strict";var t=function(t){var i=function(i,e){this.el=t(i),this.zoomFactor=1,this.lastScale=1,this.offset={x:0,y:0},this.options=t.extend({},this.defaults,e),this.setupMarkup(),this.bindEvents(),this.update(),this.enable()},e=function(t,i){return t+i},n=function(t,i){return t>i-.01&&i+.01>t};i.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:300,animationInterval:5,maxZoom:4,minZoom:.5,lockDragAxis:!1,use2d:!0,zoomStartEventName:"pz_zoomstart",zoomEndEventName:"pz_zoomend",dragStartEventName:"pz_dragstart",dragEndEventName:"pz_dragend",doubleTapEventName:"pz_doubletap"},handleDragStart:function(t){this.el.trigger(this.options.dragStartEventName),this.stopAnimation(),this.lastDragPosition=!1,this.hasInteraction=!0,this.handleDrag(t)},handleDrag:function(t){if(this.zoomFactor>1){var i=this.getTouches(t)[0];this.drag(i,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=i}},handleDragEnd:function(){this.el.trigger(this.options.dragEndEventName),this.end()},handleZoomStart:function(t){this.el.trigger(this.options.zoomStartEventName),this.stopAnimation(),this.lastScale=1,this.nthZoom=0,this.lastZoomCenter=!1,this.hasInteraction=!0},handleZoom:function(t,i){var e=this.getTouchCenter(this.getTouches(t)),n=i/this.lastScale;this.lastScale=i,this.nthZoom+=1,this.nthZoom>3&&(this.scale(n,e),this.drag(e,this.lastZoomCenter)),this.lastZoomCenter=e},handleZoomEnd:function(){this.el.trigger(this.options.zoomEndEventName),this.end()},handleDoubleTap:function(t){var i=this.getTouches(t)[0],e=this.zoomFactor>1?1:this.options.tapZoomFactor,n=this.zoomFactor,s=function(t){this.scaleTo(n+t*(e-n),i)}.bind(this);this.hasInteraction||(n>e&&(i=this.getCurrentZoomCenter()),this.animate(this.options.animationDuration,this.options.animationInterval,s,this.swing),this.el.trigger(this.options.doubleTapEventName))},sanitizeOffset:function(t){var i=(this.zoomFactor-1)*this.getContainerX(),e=(this.zoomFactor-1)*this.getContainerY(),n=Math.max(i,0),s=Math.max(e,0),o=Math.min(i,0),a=Math.min(e,0);return{x:Math.min(Math.max(t.x,o),n),y:Math.min(Math.max(t.y,a),s)}},scaleTo:function(t,i){this.scale(t/this.zoomFactor,i)},scale:function(t,i){t=this.scaleZoomFactor(t),this.addOffset({x:(t-1)*(i.x+this.offset.x),y:(t-1)*(i.y+this.offset.y)})},scaleZoomFactor:function(t){var i=this.zoomFactor;return this.zoomFactor*=t,this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom)),this.zoomFactor/i},drag:function(t,i){i&&(this.options.lockDragAxis?Math.abs(t.x-i.x)>Math.abs(t.y-i.y)?this.addOffset({x:-(t.x-i.x),y:0}):this.addOffset({y:-(t.y-i.y),x:0}):this.addOffset({y:-(t.y-i.y),x:-(t.x-i.x)}))},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(t){return{x:t.map(function(t){return t.x}).reduce(e)/t.length,y:t.map(function(t){return t.y}).reduce(e)/t.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation()},isInsaneOffset:function(t){var i=this.sanitizeOffset(t);return i.x!==t.x||i.y!==t.y},sanitizeOffsetAnimation:function(){var t=this.sanitizeOffset(this.offset),i={x:this.offset.x,y:this.offset.y},e=function(e){this.offset.x=i.x+e*(t.x-i.x),this.offset.y=i.y+e*(t.y-i.y),this.update()}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,e,this.swing)},zoomOutAnimation:function(){var t=this.zoomFactor,i=1,e=this.getCurrentZoomCenter(),n=function(n){this.scaleTo(t+n*(i-t),e)}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,n,this.swing)},updateAspectRatio:function(){this.setContainerY(this.getContainerX()/this.getAspectRatio())},getInitialZoomFactor:function(){return this.container[0].offsetWidth/this.el[0].offsetWidth},getAspectRatio:function(){return this.el[0].offsetWidth/this.el[0].offsetHeight},getCurrentZoomCenter:function(){var t=this.container[0].offsetWidth*this.zoomFactor,i=this.offset.x,e=t-i-this.container[0].offsetWidth,n=i/e,s=n*this.container[0].offsetWidth/(n+1),o=this.container[0].offsetHeight*this.zoomFactor,a=this.offset.y,h=o-a-this.container[0].offsetHeight,r=a/h,c=r*this.container[0].offsetHeight/(r+1);return 0===e&&(s=this.container[0].offsetWidth),0===h&&(c=this.container[0].offsetHeight),{x:s,y:c}},canDrag:function(){return!n(this.zoomFactor,1)},getTouches:function(t){var i=this.container.offset();return Array.prototype.slice.call(t.touches).map(function(t){return{x:t.pageX-i.left,y:t.pageY-i.top}})},animate:function(t,i,e,n,s){var o=(new Date).getTime(),a=function(){if(this.inAnimation){var h=(new Date).getTime()-o,r=h/t;h>=t?(e(1),s&&s(),this.update(),this.stopAnimation(),this.update()):(n&&(r=n(r)),e(r),this.update(),setTimeout(a,i))}}.bind(this);this.inAnimation=!0,a()},stopAnimation:function(){this.inAnimation=!1},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container[0].offsetWidth},getContainerY:function(){return this.container[0].offsetHeight},setContainerY:function(t){return this.container.height(t)},setupMarkup:function(){this.container=t('<div class="pinch-zoom-container"></div>'),this.el.before(this.container),this.container.append(this.el),this.container.css({overflow:"hidden"}),this.el.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","transform-origin":"0% 0%",position:"absolute"})},end:function(){this.hasInteraction=!1,this.sanitize(),this.update()},bindEvents:function(){s(this.container.get(0),this),t(window).on("resize",this.update.bind(this)),t(this.el).find("img").on("load",this.update.bind(this))},update:function(){this.updatePlaned||(this.updatePlaned=!0,setTimeout(function(){this.updatePlaned=!1,this.updateAspectRatio();var t=this.getInitialZoomFactor()*this.zoomFactor,i=-this.offset.x/t,e=-this.offset.y/t,n="scale3d("+t+", "+t+",1) translate3d("+i+"px,"+e+"px,0px)",s="scale("+t+", "+t+") translate("+i+"px,"+e+"px)",o=function(){this.clone&&(this.clone.remove(),delete this.clone)}.bind(this);!this.options.use2d||this.hasInteraction||this.inAnimation?(this.is3d=!0,o(),this.el.css({"-webkit-transform":n,"-o-transform":s,"-ms-transform":s,"-moz-transform":s,transform:n})):(this.is3d&&(this.clone=this.el.clone(),this.clone.css("pointer-events","none"),this.clone.appendTo(this.container),setTimeout(o,200)),this.el.css({"-webkit-transform":s,"-o-transform":s,"-ms-transform":s,"-moz-transform":s,transform:s}),this.is3d=!1)}.bind(this),0))},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1}};var s=function(t,i){var e=null,n=0,s=null,o=null,a=function(t,n){if(e!==t){if(e&&!t)switch(e){case"zoom":i.handleZoomEnd(n);break;case"drag":i.handleDragEnd(n)}switch(t){case"zoom":i.handleZoomStart(n);break;case"drag":i.handleDragStart(n)}}e=t},h=function(t){2===n?a("zoom"):1===n&&i.canDrag()?a("drag",t):a(null,t)},r=function(t){return Array.prototype.slice.call(t).map(function(t){return{x:t.pageX,y:t.pageY}})},c=function(t,i){var e,n;return e=t.x-i.x,n=t.y-i.y,Math.sqrt(e*e+n*n)},d=function(t,i){var e=c(t[0],t[1]),n=c(i[0],i[1]);return n/e},l=function(t){t.stopPropagation(),t.preventDefault()},f=function(t){var o=(new Date).getTime();if(n>1&&(s=null),300>o-s)switch(l(t),i.handleDoubleTap(t),e){case"zoom":i.handleZoomEnd(t);break;case"drag":i.handleDragEnd(t)}1===n&&(s=o)},u=!0;t.addEventListener("touchstart",function(t){i.enabled&&(u=!0,n=t.touches.length,f(t))}),t.addEventListener("touchmove",function(t){if(i.enabled){if(u)h(t),e&&l(t),o=r(t.touches);else{switch(e){case"zoom":i.handleZoom(t,d(o,r(t.touches)));break;case"drag":i.handleDrag(t)}e&&(l(t),i.update())}u=!1}}),t.addEventListener("touchend",function(t){i.enabled&&(n=t.touches.length,h(t))})};return i};"undefined"!=typeof define&&define.amd?define(["jquery"],function(i){return t(i)}):(window.RTP=window.RTP||{},window.RTP.PinchZoom=t(window.$))}).call(this),window.Swipe=function(t,i){if(!t)return null;this.options=i||{},this.index=this.options.startSlide||0,this.speed=this.options.speed||300,this.callback=this.options.callback||function(){},this.delay=this.options.auto||0,this.container=t,this.element=this.container.children[0],this.container.style.overflow="hidden",this.element.style.listStyle="none",this.setup(),this.begin(),this.element.addEventListener&&(this.element.addEventListener("touchstart",this,!1),this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1),this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("msTransitionEnd",this,!1),this.element.addEventListener("oTransitionEnd",this,!1),this.element.addEventListener("transitionend",this,!1),window.addEventListener("resize",this,!1))},Swipe.prototype={setup:function(){if(this.slides=this.element.children,this.length=this.slides.length,this.length<1)return null;if(this.width=this.container.getBoundingClientRect().width,!this.width)return null;this.container.style.visibility="hidden",this.element.style.width=this.slides.length*this.width+"px";for(var t=this.slides.length;t--;){var i=this.slides[t];i.style.width=this.width+"px",i.style.display="table-cell",i.style.verticalAlign="top"}this.slide(this.index,0),this.container.style.visibility="visible"},slide:function(t,i){var e=this.element.style;void 0==i&&(i=this.speed),e.webkitTransitionDuration=e.MozTransitionDuration=e.msTransitionDuration=e.OTransitionDuration=e.transitionDuration=i+"ms",e.MozTransform=e.webkitTransform="translate3d("+-(t*this.width)+"px,0,0)",e.msTransform=e.OTransform="translateX("+-(t*this.width)+"px)",this.index=t},getPos:function(){return this.index},prev:function(t){this.delay=t||0,clearTimeout(this.interval),this.index&&this.slide(this.index-1,this.speed)},next:function(t){this.delay=t||0,clearTimeout(this.interval),this.index<this.length-1?this.slide(this.index+1,this.speed):this.slide(0,this.speed)},begin:function(){var t=this;this.interval=this.delay?setTimeout(function(){t.next(t.delay)},this.delay):0},stop:function(){this.delay=0,clearTimeout(this.interval)},resume:function(){this.delay=this.options.auto||0,this.begin()},handleEvent:function(t){switch(t.type){case"touchstart":this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.onTouchEnd(t);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.transitionEnd(t);break;case"resize":this.setup()}},transitionEnd:function(t){this.delay&&this.begin(),this.callback(t,this.index,this.slides[this.index])},onTouchStart:function(t){this.start={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,time:Number(new Date)},this.isScrolling=void 0,this.deltaX=0,this.element.style.MozTransitionDuration=this.element.style.webkitTransitionDuration=0},onTouchMove:function(t){t.touches.length>1||t.scale&&1!==t.scale||(this.deltaX=t.touches[0].pageX-this.start.pageX,"undefined"==typeof this.isScrolling&&(this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(t.touches[0].pageY-this.start.pageY))),this.isScrolling||(t.preventDefault(),clearTimeout(this.interval),this.deltaX=this.deltaX/(!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0?Math.abs(this.deltaX)/this.width+1:1),this.element.style.MozTransform=this.element.style.webkitTransform="translate3d("+(this.deltaX-this.index*this.width)+"px,0,0)"))},onTouchEnd:function(t){var i=Number(new Date)-this.start.time<250&&Math.abs(this.deltaX)>20||Math.abs(this.deltaX)>this.width/2,e=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;this.isScrolling||this.slide(this.index+(i&&!e?this.deltaX<0?1:-1:0),this.speed)}};